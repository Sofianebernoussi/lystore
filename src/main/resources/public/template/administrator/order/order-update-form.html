<article ng-controller="orderRegionController" class=" order-client-sent">
    <h1>
        <i18n>lystore.order.update</i18n>
    </h1>
    <form>
        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>lystore.structure.label</i18n>
                :
            </label>
            <label class="six cell">[[orderToUpdate.structure.name]]</label>
        </div>
        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>CAMPAIGN</i18n>
            </label>
            <label class="six cell">[[orderToUpdate.campaign.name]]</label>
        </div>
        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>lystore.project</i18n>
            </label>
            <label class="six cell">[[orderToUpdate.title.name]]</label>
        </div>
        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>lystore.project.comment</i18n>
            </label>
            <label ng-if="orderToUpdate.project.description"
                   class="six cell comment">[[orderToUpdate.project.description]]</label>

            <label ng-if="!orderToUpdate.project.description"
                   class="six cell">-</label>
        </div>
        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>room</i18n>
            </label>
            <label class="six cell">[[orderToUpdate.project.room]]</label>
        </div>
        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>building</i18n>
            </label>
            <label class="six cell">[[orderToUpdate.project.building]]</label>
        </div>

        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>lystore.contract.type.name</i18n>
            </label>
            <label class="six cell">[[orderToUpdate.order_client_equipment_parent.contract_type.name]]</label>
        </div>

        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>lystore.amountTTC</i18n>
            </label>
            <span
                    class="four cell horizontal-margin"
                   ng-if="orderToUpdate.order_client_equipment_parent"
            >
                [[orderToUpdate.order_client_equipment_parent.price_total]] €
            </span>
            <label
                   class="cell horizontal-margin"
                   ng-class="{'two': orderToUpdate.order_client_equipment_parent, 'six': !orderToUpdate.order_client_equipment_parent}"
            >
                [[orderToUpdate.price_proposal * orderToUpdate.amount]] €
            </label>
        </div>

        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>EQUIPMENT</i18n>
            </label>
            <span
                    class="four cell horizontal-margin"
                    ng-if="orderToUpdate.order_client_equipment_parent"
            >
                [[orderToUpdate.order_client_equipment_parent.contract_type.name]]&nbsp
                -&nbsp
                [[orderToUpdate.order_client_equipment_parent.name]]
            </span>
            <search-and-select
                    ng-change="getContractType()"
                    class="four cell"
                    options="equipments.all"
                    param1="'contract_type_name'"
                    param2="'name'"
                    ng-model="orderToUpdate.equipment"
                    search-on="name"
                    order-by="name"
                    class="cell horizontal-margin"
                    ng-class="{'four': orderToUpdate.order_client_equipment_parent, 'six': !orderToUpdate.order_client_equipment_parent}"
            >
            </search-and-select>
        </div>

        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>quantity.full</i18n>
            </label>
            <span
                    class="four cell horizontal-margin"
                    ng-if="orderToUpdate.order_client_equipment_parent"
            >
                [[orderToUpdate.order_client_equipment_parent.amount]]
            </span>
            <input
                    min="0"
                    type="number"
                    ng-model="orderToUpdate.amount"
                    class="cell horizontal-margin"
                    ng-class="{'two': orderToUpdate.order_client_equipment_parent}"
            />

        </div>

        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>lystore.price.TTC</i18n>
            </label>
            <span
                    class="four cell horizontal-margin"
                    ng-if="orderToUpdate.order_client_equipment_parent"
            >
                [[orderToUpdate.order_client_equipment_parent.price_united]] €
            </span>
            <input type="number"
                   step="0.01"
                   min="0"
                   ng-model="orderToUpdate.price_proposal "
                   class="cell horizontal-margin"
                   ng-class="{'two': orderToUpdate.order_client_equipment_parent}"
            />
        </div>


        <div ng-if="orderToUpdate.campaign.orderPriorityEnable()"
             class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>lystore.project.priority.order</i18n>
            </label>
            <span
                    class="four cell horizontal-margin"
                    ng-if="orderToUpdate.order_client_equipment_parent"
            >
                [[orderToUpdate.order_client_equipment_parent.rank]]
            </span>
            <input
                    ng-model="orderToUpdate.rank"
                    type="number"
                    min="1"
                    step="1"
                    max="10"
                    class="cell horizontal-margin"
                    ng-class="{'two': orderToUpdate.order_client_equipment_parent}"
            />
        </div>

        <div class="row vertical-spacing-four">
            <label class="two right-padding-form-field cell">
                <i18n>comment</i18n>
            </label>
            <textarea readonly
                      auto-height=""
                      style="resize: none; height: 62px;"
                      ng-model="orderToUpdate.order_client_equipment_parent.comment"
                      class="ng-pristine ng-valid ng-touched four cell horizontal-margin"
                      ng-if="orderToUpdate.order_client_equipment_parent"
            >
            </textarea>
            <textarea auto-height=""
                      style="resize: none; height: 62px;"
                      ng-model="orderToUpdate.comment"
                      class="ng-pristine ng-valid ng-touched cell horizontal-margin"
                      ng-class="{'four': orderToUpdate.order_client_equipment_parent}">
            >
            </textarea>
        </div>

        <lightbox on-close="display.lightbox.validOrder = false;"
                  show="display.lightbox.validOrder">
            <container template="validOrder.lightbox"></container>
        </lightbox>
        <div class="row">
            <div class="right-magnet">
                <input type="button" class=" cancel" ng-click="cancelUpdate()"
                       i18n-value="cancel"/>

                <input type="button" ng-if="isUpdating" class=" button" ng-disabled="!isValidFormUpdate()"
                       ng-click="updateOrderConfirm()"
                       i18n-value="lystore.order.operation.select"/>

                <input type="button" ng-if="isUpdatingFromOrder" ng-disabled="!isValidFormUpdate()" class=" button"
                       ng-click="updateLinkedOrderConfirm()"
                       i18n-value="confirm"/>

            </div>
        </div>
    </form>
</article>